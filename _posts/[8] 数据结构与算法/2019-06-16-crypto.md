---
layout: post
title: 加密法
categories:
tags: 8_数据结构与算法
keywords:
description:
order: 173
---


## 混沌加密法
混沌加密法有两个关键技术点：
1. 混沌迭代式 $x_n=ux_{n-1}(1-x_{n-1}),(u \in (3.5699456,4],x_0 \in (0,1))$，呈现混沌性。一方面如果你不知道参数，你无法根据迭代结果求出参数；另一方面，如果你知道参数，那么每次迭代的序列都是一样的。
2. $a\oplus b \oplus=a,\forall a,b$,异或求两次还是自身


迭代加密/解密函数：  
思路是，混沌迭代式的n到m位，与原序列求异或。
```py
def func_chaos(password, input_data):
    u, x, n = password
    output_data = []
    for i in range(n):
        x = u * x * (1 - x)
    for i in input_data:
        x = u * x * (1 - x)
        output_data.append(i ^ (int(x * 127))) # 加密字符串时，是ascii码，所以是127。加密图像用255
    return output_data
```

数据准备
```py
input_data = 'http://www.guofei.site'
password = (3.7, 0.2, 10)
```

加密
```py
clear_data = [ord(i) for i in input_data]
cypher_data = func_chaos(password, clear_data)

cypher_text = [chr(i) for i in cypher_data]
print('加密后：')
print(cypher_data)
print(''.join(cypher_text))
```

解密，和加密完全一样
```py
predict_data = func_chaos(password, cypher_data)
predict_text = [chr(i) for i in predict_data]
print('加密后：')
print(predict_data)
print(''.join(predict_text))
```

## 实践
### 文本加密
- 除了用混沌生成器之外，你还可以用随机数生成器
- 如果是长文本，你还不想在代码里写太多东西，你可以把信息放网上，只加密链接

```py
input_data = 'http://www.guofei.site/m/m.md' # 如果你加密对象是一个url，你就能存入大量信息
password = 0
np.random.seed(password)
cypher_data = [ord(i) ^ np.random.randint(127) for i in input_data]
''.join([chr(i) for i in cypher_data])
```

解密
```py
password = 0
cypher_str = 'D[\x010yTl\x10~$;\x15Q8 =1"I(\x12BxCw<\x0bt)'
np.random.seed(password)
clear_data = [chr(ord(i) ^ np.random.randint(127)) for i in cypher_str]
url=''.join(clear_data)
requests.get(url).content.decode('utf-8')
```

### 加密图像
- 加密
```
input_data = plt.imread('test.jpg')
np.random.seed(0)
cypher_data = input_data ^ np.random.randint(0, 255, size=input_data.shape)
plt.imshow(cypher_data)
```
- 解密
```
np.random.seed(0)
clear_data = cypher_data ^ np.random.randint(0, 255, size=cypher_data.shape)
plt.imshow(clear_data)
```

## 图像盲水印
https://github.com/guofei9987/blind_watermark  
还有些问题：
1. 对剪切、压缩等的鲁棒性
2. 加密方法需要改成这篇blog的方法
