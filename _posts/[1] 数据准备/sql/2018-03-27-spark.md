---
layout: post
title: spark用法速查.
categories:
tags: 1数据准备
keywords:
description:
order: 151
---

## Spark与Hive的交互
### Hive to Spark
```py
from pyspark.sql import SparkSession
spark = SparkSession.builder.appName("test").enableHiveSupport().getOrCreate()
df_data = spark.sql('select ...') #返回spark下的DataFrame类型
```
### Spark to Hive
```py
df_data.toDF('col_name1','col_name2').registerTempTable("table3")
spark.sql("create table tmp.tmp_test_pyspark2hive as select * from table3")
# table3可以作为一个表用了，因此还有众多可以写sql的用法
```

## Spark与pandas的交互
### spark to pandas

```py
df_data.toPandas() #返回DataFrame类型
```
### pandas to spark
```py
spark.createDataFrame(<pd.DataFrame>)
```




## 输出到本地硬盘
```py
<pd.DataFrame>.to_csv('') #pandas 存储到本地csv
os.system("hive -e 'select * from ...'>test.csv") #hive存储到本地csv
```
