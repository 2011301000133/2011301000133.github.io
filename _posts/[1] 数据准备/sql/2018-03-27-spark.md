---
layout: post
title: spark用法速查.
categories:
tags: 1数据准备
keywords:
description:
order: 151
---


## Hive to Spark
```py
from pyspark.sql import SparkSession
spark = SparkSession.builder.appName("test").enableHiveSupport().getOrCreate()
df_data = spark.sql('select ...') #返回spark下的DataFrame类型
```

## spark to pandas

```py
df_data.toPandas() #返回DataFrame类型
```

## spark to hive

```py
df_data.toDF('a','b','c','d','e','f').registerTempTable("table3")
sql("create table tmp.tmp_test_pyspark2hive as select * from table3")
```
