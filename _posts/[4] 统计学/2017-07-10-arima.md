---
layout: post
title: ARIMA.
categories:
tags: 4统计学
keywords:
description:
order: 433
---

## ARIMA(p,d,q)模型介绍

ARMA模型的前提是数据平稳。  

### AR(p)模型
$AR(p):y_t=c+\alpha_1 y_{t-1}+\alpha_2 y_{t-2}+...+\alpha_p y_{t-p}+\varepsilon_t$  

### MA(q)模型
$MA(q):y_t=c+\varepsilon_t+\theta_1 \varepsilon_{t-1}+\theta_2 \varepsilon_{t-2}+...+\theta_q \varepsilon_{t-q}$  

### ARMA(p,q)模型
$ARMA(p,q):y_t=c+\alpha_1 y_{t-1}+\alpha_2 y_{t-2}+...+\alpha_p y_{t-p}+\varepsilon_t$
$+\theta_1 \varepsilon_{t-1}+\theta_2 \varepsilon_{t-2}+...+\theta_q \varepsilon_{t-q}$


## p,d,q的确定

### d的识别
ARMA模型要求数据平稳，当数据不平稳时，需要差分。如果d阶差分后，序列平稳，叫做`d阶单整序列`  
如果差分很多次，还是不平稳。或者差分后已经失去研究意义了，那么就放弃ARIMA模型。  

### p,q的识别

||AR(p)|MA(q)|ARMA(p,q)|
|--|--|--|--|
|ACF|拖尾|q期后截尾|拖尾|
|PACF|p期后截尾|拖尾|拖尾|

## ACF和PACF

### ACF

自相关系数ACF的定义：  
$r_k=\rho(y_t,y_{t-k})=\dfrac{cov(y_t,y_{t-k})}{\sqrt{var(y_t)var(y_{t-k})}}$  

计算公式是：  
$r_k=\dfrac{\sum\limits_{t=1}^{n-k}(Y_t-\bar Y)(Y_{t+k}-\bar Y)}{\sum\limits_{t=1}^n(Y_t-\bar Y)^2}$

ACF也是一个随机变量。当序列$\{ Y_t \}$是完全随机序列时，$ACF\sim N(0,1/\sqrt n )$

### PACF  

偏自相关系数PACF的定义：$Y_t$在给定$Y_{t-1},Y_{t-2},...Y_{t-k+1}$的条件下，$Y_t$与$Y_{t-k}$之间的条件相关。  

$$\phi_{kk} = \left \{ \begin{array}{ccc}
r_1,&&k=1\\
\dfrac{r_k-\sum\limits_{j=1}^{k-1} \phi_{k-1,j}\centerdot r_{k-j}}{1-\sum\limits_{j=1}^{k-1}\phi_{k-1,j} \centerdot r_j}&&k=2,3,...
\end{array}\right.$$  

其中，  
$\phi_{k-j}=\phi_{k-1,j}-\phi_{kk}\phi_{k-1,k-j}$  


## 时间序列的平稳性

### 严格平稳过程

**定义：**  
${Y_t}$是一个严格随机过程，如果$\forall n,h,$  
$F_{Y_{t_1},Y_{t_2},...,Y_{t_n}}(Y_1,...,Y_n)=F_{Y_{t_1+h},Y_{t_2+h},...,Y_{t_n+h}}(Y_1,...,Y_n)$  

### 弱平稳过程

指的是${Y_t}$的期望、方差、协方差不随时间推移而变化
**定义：**
${Y_t}$是一个随机过程，如果$\forall t $  

$E(Y_t)=u$  
$Var(Y_t)=\sigma^2$  
$Cov(Y_t,Y_s)=Cov(Y_{t+h},Y_{s+h})=r_{t-s}$  
那么${Y_t}$是一个弱平稳随机过程  

在时间序列中讨论的平稳，通常指弱平稳  

### 非平稳的后果
伪回归的根本原因在于时间序列的非平稳性。  
用传统方法对彼此不相关的非平稳变量进行回归，那么t检验和F检验往往倾向于显著  

### DF检验
Dickey-Fuller（DF），Augmented Dickey-Fuller test（ADF）  

DF检验有三种形式：  
$y_t=\rho y_{t-1}+\varepsilon_t$  
$y_t=\alpha+\rho y_{t-1}+\varepsilon_t$  
$y_t=\alpha+\delta t+\rho y_{t-1}+\varepsilon_t$  

如果$\mid \rho \mid<1$，序列$y_t$是平稳的  
如果$\mid \rho \mid=1$，序列$y_t$是非平稳的，但一阶差分是平稳的。  
如果$\mid \rho \mid>1$，序列$y_t$是发散的  

step1:建立假设  
H0：$\rho =1$  
H1：$\mid \rho \mid<1$  

step2：进行t检验  


通常用这样的检验方程：  
$\Delta y_t=\gamma y_{t-1}+\varepsilon_t$  
$\Delta y_t=\alpha+\gamma y_{t-1}+\varepsilon_t$  
$\Delta y_t=\alpha+\delta t+\gamma y_{t-1}+\varepsilon_t$  

问题转化为检验$\gamma=0$  

### ADF检验
DF检验只适合一阶自相关的情况。  
ADF（augmented Dickey-Fuller test,增广的迪基-福勒检验法）检验适合`高阶自相关`的情况  

ADF检验有三种形式：  
$\Delta y_t=\gamma y_{t-1}+\sum\limits_{i=1}^l \beta_i \Delta y_{t-i}+\varepsilon_t$  
$\Delta y_t=\alpha+\gamma y_{t-1}+\sum\limits_{i=1}^l \beta_i \Delta y_{t-i}+\varepsilon_t$  
$\Delta y_t=\alpha+\delta t+\gamma y_{t-1}+\sum\limits_{i=1}^l \beta_i \Delta y_{t-i}+\varepsilon_t$  
