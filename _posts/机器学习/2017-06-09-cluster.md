---
layout: post
title: 【Kmeans】快速聚类的Python实现.
categories: 算法
tags: 机器学习
keywords:
description:
---

## Kmeans算法原理

Kmeans的算法原理简单但很巧妙。  
### 算法
要把N个点分为k个类，算法过程如下：
1. N个点中，随机选取k个点作为中心
2. 检查所有点与这k个点之间的距离，每个点归类到最近的中心
3. 计算每个新类的中心，共k个
4. 如果新中心与原中心的距离之和大于某个阈值，回到2。否则算法结束

## 评价
优点：  
复杂度为$O(nkt)$，n是数据点个数，k是要分类数，t是总共的迭代次数。  
因此，可以处理大量数据。  

缺点：  
- 只能处理球状分布的数据
- 容易局部最优
- 用户要先给出k值
- 对离群值非常敏感

## Kmeans的Python实现
step1：生成模拟数据
```
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
data1=pd.DataFrame({'x':np.random.normal(0,1,size=50),'y':np.random.normal(0,1,size=50)})
data2=pd.DataFrame({'x':np.random.normal(0,1,size=50),'y':np.random.normal(8,1,size=50)})
data3=pd.DataFrame({'x':np.random.normal(4,1,size=50),'y':np.random.normal(4,1,size=50)})
data=pd.concat([data1,data2,data3])
```


step2：画图
```py
plt.plot(data.x,data.y,'r.')
plt.show()
```
模拟数据是这样的：
<img src='http://www.guofei.site/public/postimg/kmeans1.png'>

step3：聚类
```py
from sklearn.cluster import KMeans
kmeans=KMeans(n_clusters=3)
kmeans.fit(data)
```


step4：画图
```py
cen=kmeans.cluster_centers_#中心点
plt.plot(data.x,data.y,'r.')
plt.plot(cen[:,0],cen[:,1],'b^')
plt.show()
```
得到中心点的位置图：  
<img src='http://www.guofei.site/public/postimg/kmeans2.png'>

## Kmeans的改进：二分Kmeans算法  
二分Kmeans算法(Bisecting Kmeans)是在Kmeans的基础上改进的。    
为介绍算法，首先引入聚类结果的一个评价指标：误差平方和  
误差平方和是每个点到对应中心点的距离的平方和   
$$SSE=\sum\limits_{m=1}^k\sum_{p_m \in C_m} \sum_{j=1}^{n_{C_i}}(p_{ij}-c_{ij})^2$$    
其中，模型把数据分为k类，每个类的集合为$C_i$    

Bisecting Kmeans算法流程：
1. 把所有点分为1个类
2. 对这个类进行二分类。用Kmeans方法，k=2，进行m次二分类，选取其中SSE最小者作为正确的分类。
3. 在所有的集合中，选取SSE最大的集合，用Kmeans把这个集合分为2个集合。分类时，同样用Kmeans方法，k=2，m次Kmeans，选取SSE最小者。
4. 重复3，直到分为k类为止。
